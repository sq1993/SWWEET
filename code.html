<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>æ‰‹æœºå‹å¥½å‹æ¢¦å¹»åœ£è¯æ ‘</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background: #000;
            touch-action: manipulation;
        }
        .info {
            position: absolute;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #fff;
            font-family: Arial, sans-serif;
            text-shadow: 0 0 5px #fff;
            text-align: center;
            width: 100%;
        }
        .controls {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            z-index: 10;
        }
        .btn {
            padding: 6px 10px;
            background: rgba(255,255,255,0.2);
            color: #fff;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            backdrop-filter: blur(5px);
            font-size: 14px;
        }
        .btn:hover {
            background: rgba(255,255,255,0.4);
        }
    </style>
</head>
<body>
    <div class="info">Merry Christmas ğŸ„</div>
    <div class="controls">
        <button class="btn" id="colorBtn">åˆ‡æ¢ä¸»é¢˜</button>
        <button class="btn" id="snowBtn">é›ªèŠ±æ¨¡å¼</button>
        <button class="btn" id="speedBtn">é™ä½ç²’å­æ•°</button>
    </div>
    <script type="importmap">
        {
            "imports": {
                "three": "https://unpkg.com/three@0.150.0/build/three.module.js",
                "three/addons/": "https://unpkg.com/three@0.150.0/examples/jsm/"
            }
        }
    </script>
    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        // è®¾å¤‡åˆ¤æ–­ï¼Œæ‰‹æœºç«¯é™ä½ç²’å­æ•°å’Œæ•ˆæœå¤æ‚åº¦
        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        const particleCount = isMobile ? 6000 : 12000;

        // åˆå§‹åŒ–åœºæ™¯ã€ç›¸æœºã€æ¸²æŸ“å™¨
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 8;

        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2)); // é™åˆ¶åƒç´ æ¯”ï¼Œé™ä½æ‰‹æœºæ€§èƒ½æ¶ˆè€—
        document.body.appendChild(renderer.domElement);

        // è½¨é“æ§åˆ¶å™¨ï¼Œä¼˜åŒ–æ‰‹æœºè§¦æ‘¸ä½“éªŒ
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.08;
        controls.rotateSpeed = 0.4;
        controls.enablePan = false; // æ‰‹æœºç«¯ç¦ç”¨å¹³ç§»ï¼Œé¿å…è¯¯æ“ä½œ
        controls.enableZoom = true;
        controls.zoomSpeed = 0.5;

        // ç¯å¢ƒå…‰
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.3);
        scene.add(ambientLight);

        // ç‚¹å…‰æº
        const pointLight = new THREE.PointLight(0xff69b4, 1, 100);
        pointLight.position.set(0, 3, 5);
        scene.add(pointLight);

        // åœ£è¯æ ‘ç²’å­ç³»ç»Ÿ
        const particles = new THREE.BufferGeometry();
        const positions = new Float32Array(particleCount * 3);
        const colors = new Float32Array(particleCount * 3);
        const sizes = new Float32Array(particleCount);

        // ç”Ÿæˆåœ£è¯æ ‘å½¢çŠ¶ï¼ˆåˆ†å±‚ï¼‰
        const treeSections = [
            { height: 6, radius: 4, color: new THREE.Color(0xff69b4) },
            { height: 4, radius: 3, color: new THREE.Color(0xffc0cb) },
            { height: 2, radius: 2, color: new THREE.Color(0x98fb98) },
        ];

        let index = 0;
        treeSections.forEach(section => {
            const { height, radius, color } = section;
            for (let i = 0; i < particleCount / treeSections.length; i++) {
                const t = Math.random() * height;
                const r = radius * (1 - t / height);
                const theta = Math.random() * Math.PI * 2;
                const x = r * Math.cos(theta);
                const y = t - height / 2;
                const z = r * Math.sin(theta);

                positions[index * 3] = x;
                positions[index * 3 + 1] = y;
                positions[index * 3 + 2] = z;

                // é¢œè‰²æ¸å˜
                const particleColor = new THREE.Color().copy(color);
                particleColor.lerp(new THREE.Color(0xffffff), Math.random() * 0.5);
                colors[index * 3] = particleColor.r;
                colors[index * 3 + 1] = particleColor.g;
                colors[index * 3 + 2] = particleColor.b;

                // ç²’å­å¤§å°
                sizes[index] = Math.random() * 0.08 + 0.02;

                index++;
            }
        });

        particles.setAttribute('position', 
